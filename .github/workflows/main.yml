

name: Java File Report

on:
	push:
		paths:
			- 'BankApplication/**'
	pull_request:
		paths:
			- 'BankApplication/**'

jobs:
	java-file-report:
		runs-on: ubuntu-latest
		defaults:
			run:
				working-directory: ..
		steps:
			- name: Checkout code
				uses: actions/checkout@v4
			- name: Find .java files and count lines
				id: count_java
				run: |
					JAVA_FILES=$(find BankApplication -type f -name '*.java')
					if [ -z "$JAVA_FILES" ]; then
						echo "No .java files found!" >&2
						exit 1
					fi
					TOTAL=0
					echo "Java File Report" > VALIDATION-LOGICIELLE/java-file-report.txt
					echo "================" >> VALIDATION-LOGICIELLE/java-file-report.txt
					COUNT=$(echo "$JAVA_FILES" | wc -l)
					echo "Number of .java files: $COUNT" >> VALIDATION-LOGICIELLE/java-file-report.txt
					for f in $JAVA_FILES; do
						LINES=$(wc -l < "$f")
						echo "$f â€“ $LINES" >> VALIDATION-LOGICIELLE/java-file-report.txt
						TOTAL=$((TOTAL + LINES))
					done
					echo "Total lines of code: $TOTAL" >> VALIDATION-LOGICIELLE/java-file-report.txt
			- name: Fail if any .class files are committed
				run: |
					CLASS_FILES=$(git ls-files 'BankApplication/**/*.class')
					if [ -n "$CLASS_FILES" ]; then
						echo "Error: .class files are committed!" >&2
						echo "$CLASS_FILES" >&2
						exit 1
					fi
			- name: Upload java-file-report.txt
				uses: actions/upload-artifact@v4
				with:
					name: java-file-report
					path: VALIDATION-LOGICIELLE/java-file-report.txt
